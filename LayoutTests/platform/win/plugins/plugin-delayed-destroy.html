<html>
<body>
    <pre id="console"></pre>
    <div id="outer">
        <embed id="plg" type="application/x-webkit-test-netscape" onDestroy="pluginDestroyed()"></embed>
    </div>
    <script>
        function log(message)
        {
            document.getElementById("console").appendChild(document.createTextNode(message + "\n"));
        }

        function pluginDestroyed()
        {
            log("Plug-in destroyed.")
            layoutTestController.notifyDone();
        }

        if (window.layoutTestController) {
            layoutTestController.waitUntilDone();
            layoutTestController.dumpAsText();
        }

        var plugin = document.getElementById("plg");

        plugin.testEvaluate("window.document.getElementById('outer').innerHTML = '';");

        log("The should be printed before destroy.");
    </script>
</body>
</html>
