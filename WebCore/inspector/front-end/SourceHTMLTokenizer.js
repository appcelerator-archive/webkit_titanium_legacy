/* Generated by re2c 0.13.5 on Tue Jan 26 01:16:33 2010 */
/*
 * Copyright (C) 2009 Google Inc. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

// Generate js file as follows:
//
// re2c -isc WebCore/inspector/front-end/SourceHTMLTokenizer.re2js \
// | sed 's|^yy\([^:]*\)*\:|case \1:|' \
// | sed 's|[*]cursor[+][+]|this._charAt(cursor++)|' \
// | sed 's|[[*][+][+]cursor|this._charAt(++cursor)|' \
// | sed 's|[*]cursor|this._charAt(cursor)|' \
// | sed 's|yych = \*\([^;]*\)|yych = this._charAt\1|' \
// | sed 's|{ gotoCase = \([^; continue; };]*\)|{ gotoCase = \1; continue; }|' \
// | sed 's|unsigned\ int|var|' \
// | sed 's|var\ yych|case 1: case 1: var yych|'

WebInspector.SourceHTMLTokenizer = function()
{
    WebInspector.TextEditorHighlighter.Tokenizer.call(this);

    this._lexConditions = {
        INITIAL: 0,
        COMMENT: 1,
        DSTRING: 2,
        SSTRING: 3
    };

    this._parseConditions = {
        INITIAL: 0,
        TAG: 1,
        ATTRIBUTE: 2,
        ATTRIBUTE_VALUE: 3,
        DOCTYPE: 4
    };

    this.case_INITIAL = 1000;
    this.case_COMMENT = 1001;
    this.case_DSTRING = 1002;
    this.case_SSTRING = 1003;

    this.initialCondition = { lexCondition: this._lexConditions.INITIAL, parseCondition: this._parseConditions.INITIAL };
}

WebInspector.SourceHTMLTokenizer.prototype = {
    _stringToken: function(cursor, stringEnds)
    {
        if (this._parseCondition === this._parseConditions.ATTRIBUTE_VALUE) {
            this.tokenType = "html-attr-value";
            if (stringEnds)
                this._parseCondition = this._parseConditions.ATTRIBUTE;
        } else if (this._parseCondition === this._parseConditions.DOCTYPE)
            this.tokenType = "html-doctype";
        else
            this.tokenType = null;
        return cursor;
    },

    nextToken: function(cursor)
    {
        var cursorOnEnter = cursor;
        var gotoCase = 1;
        while (1) {
            switch (gotoCase)
            // Following comment is replaced with generated state machine.
            
        {
            case 1: var yych;
            var yyaccept = 0;
            if (this.getLexCondition() < 2) {
                if (this.getLexCondition() < 1) {
                    { gotoCase = this.case_INITIAL; continue; };
                } else {
                    { gotoCase = this.case_COMMENT; continue; };
                }
            } else {
                if (this.getLexCondition() < 3) {
                    { gotoCase = this.case_DSTRING; continue; };
                } else {
                    { gotoCase = this.case_SSTRING; continue; };
                }
            }
/* *********************************** */
case this.case_COMMENT:

            yych = this._charAt(cursor);
            if (yych <= '\f') {
                if (yych == '\n') { gotoCase = 4; continue; };
                { gotoCase = 3; continue; };
            } else {
                if (yych <= '\r') { gotoCase = 4; continue; };
                if (yych == '-') { gotoCase = 6; continue; };
                { gotoCase = 3; continue; };
            }
case 2:
            { this.tokenType = "html-comment"; return cursor; }
case 3:
            yyaccept = 0;
            yych = this._charAt(YYMARKER = ++cursor);
            { gotoCase = 9; continue; };
case 4:
            ++cursor;
case 5:
            { this.tokenType = null; return cursor; }
case 6:
            yyaccept = 1;
            yych = this._charAt(YYMARKER = ++cursor);
            if (yych != '-') { gotoCase = 5; continue; };
case 7:
            ++cursor;
            yych = this._charAt(cursor);
            if (yych == '>') { gotoCase = 10; continue; };
case 8:
            yyaccept = 0;
            YYMARKER = ++cursor;
            yych = this._charAt(cursor);
case 9:
            if (yych <= '\f') {
                if (yych == '\n') { gotoCase = 2; continue; };
                { gotoCase = 8; continue; };
            } else {
                if (yych <= '\r') { gotoCase = 2; continue; };
                if (yych == '-') { gotoCase = 12; continue; };
                { gotoCase = 8; continue; };
            }
case 10:
            ++cursor;
            this.setLexCondition(this._lexConditions.INITIAL);
            { this.tokenType = "html-comment"; return cursor; }
case 12:
            ++cursor;
            yych = this._charAt(cursor);
            if (yych == '-') { gotoCase = 7; continue; };
            cursor = YYMARKER;
            if (yyaccept <= 0) {
                { gotoCase = 2; continue; };
            } else {
                { gotoCase = 5; continue; };
            }
/* *********************************** */
case this.case_DSTRING:
            yych = this._charAt(cursor);
            if (yych <= '\f') {
                if (yych == '\n') { gotoCase = 18; continue; };
                { gotoCase = 17; continue; };
            } else {
                if (yych <= '\r') { gotoCase = 18; continue; };
                if (yych == '"') { gotoCase = 20; continue; };
                { gotoCase = 17; continue; };
            }
case 16:
            { return this._stringToken(cursor); }
case 17:
            yych = this._charAt(++cursor);
            { gotoCase = 24; continue; };
case 18:
            ++cursor;
            { this.tokenType = null; return cursor; }
case 20:
            ++cursor;
case 21:
            this.setLexCondition(this._lexConditions.INITIAL);
            { return this._stringToken(cursor, true); }
case 22:
            yych = this._charAt(++cursor);
            { gotoCase = 21; continue; };
case 23:
            ++cursor;
            yych = this._charAt(cursor);
case 24:
            if (yych <= '\f') {
                if (yych == '\n') { gotoCase = 16; continue; };
                { gotoCase = 23; continue; };
            } else {
                if (yych <= '\r') { gotoCase = 16; continue; };
                if (yych == '"') { gotoCase = 22; continue; };
                { gotoCase = 23; continue; };
            }
/* *********************************** */
case this.case_INITIAL:
            yych = this._charAt(cursor);
            if (yych <= '>') {
                if (yych <= '\'') {
                    if (yych == '"') { gotoCase = 29; continue; };
                    if (yych >= '\'') { gotoCase = 30; continue; };
                } else {
                    if (yych <= ';') { gotoCase = 27; continue; };
                    if (yych <= '<') { gotoCase = 31; continue; };
                    if (yych <= '=') { gotoCase = 33; continue; };
                    { gotoCase = 35; continue; };
                }
            } else {
                if (yych <= '_') {
                    if (yych <= '@') { gotoCase = 27; continue; };
                    if (yych <= 'Z') { gotoCase = 37; continue; };
                    if (yych >= '_') { gotoCase = 37; continue; };
                } else {
                    if (yych <= '`') { gotoCase = 27; continue; };
                    if (yych <= 'z') { gotoCase = 37; continue; };
                    if (yych >= 0x80) { gotoCase = 37; continue; };
                }
            }
case 27:
            ++cursor;
case 28:
            { this.tokenType = null; return cursor; }
case 29:
            yyaccept = 0;
            yych = this._charAt(YYMARKER = ++cursor);
            { gotoCase = 68; continue; };
case 30:
            yyaccept = 0;
            yych = this._charAt(YYMARKER = ++cursor);
            { gotoCase = 62; continue; };
case 31:
            yyaccept = 1;
            yych = this._charAt(YYMARKER = ++cursor);
            if (yych == '!') { gotoCase = 42; continue; };
            if (yych == '/') { gotoCase = 41; continue; };
case 32:
            {
                    this.tokenType = "html-tag";
                    this._parseCondition = this._parseConditions.TAG;
                    return cursor;
                }
case 33:
            ++cursor;
            {
                    if (this._parseCondition === this._parseConditions.ATTRIBUTE) {
                        this.tokenType = null;
                        this._parseCondition = this._parseConditions.ATTRIBUTE_VALUE;
                    } else if (this._parseCondition === this._parseConditions.DOCTYPE)
                        this.tokenType = "html-doctype";
                    else
                        this.tokenType = null;
                    return cursor;
                }
case 35:
            ++cursor;
            {
                    if (this._parseCondition === this._parseConditions.DOCTYPE)
                        this.tokenType = "html-doctype";
                    else
                        this.tokenType = "html-tag";
                    this._parseCondition = this._parseConditions.INITIAL;
                    return cursor;
                }
case 37:
            ++cursor;
            yych = this._charAt(cursor);
            { gotoCase = 40; continue; };
case 38:
            {
                    if (this._parseCondition === this._parseConditions.TAG) {
                        this.tokenType = "html-tag";
                        this._parseCondition = this._parseConditions.ATTRIBUTE;
                    } else if (this._parseCondition === this._parseConditions.ATTRIBUTE) {
                        this.tokenType = "html-attr-name";
                        this._parseCondition = this._parseConditions.ATTRIBUTE;
                    } else if (this._parseCondition === this._parseConditions.ATTRIBUTE_VALUE) {
                        this.tokenType = "html-attr-value";
                        this._parseCondition = this._parseConditions.ATTRIBUTE;
                    } else if (this._parseCondition === this._parseConditions.DOCTYPE)
                        this.tokenType = "html-doctype";
                    else
                        this.tokenType = null;
                    return cursor;
                }
case 39:
            ++cursor;
            yych = this._charAt(cursor);
case 40:
            if (yych <= '_') {
                if (yych <= '@') { gotoCase = 38; continue; };
                if (yych <= 'Z') { gotoCase = 39; continue; };
                if (yych <= '^') { gotoCase = 38; continue; };
                { gotoCase = 39; continue; };
            } else {
                if (yych <= '`') { gotoCase = 38; continue; };
                if (yych <= 'z') { gotoCase = 39; continue; };
                if (yych <= 0x7F) { gotoCase = 38; continue; };
                { gotoCase = 39; continue; };
            }
case 41:
            yych = this._charAt(++cursor);
            { gotoCase = 32; continue; };
case 42:
            yych = this._charAt(++cursor);
            if (yych <= 'C') {
                if (yych == '-') { gotoCase = 44; continue; };
            } else {
                if (yych <= 'D') { gotoCase = 45; continue; };
                if (yych == 'd') { gotoCase = 45; continue; };
            }
case 43:
            cursor = YYMARKER;
            if (yyaccept <= 0) {
                { gotoCase = 28; continue; };
            } else {
                { gotoCase = 32; continue; };
            }
case 44:
            yych = this._charAt(++cursor);
            if (yych == '-') { gotoCase = 53; continue; };
            { gotoCase = 43; continue; };
case 45:
            yych = this._charAt(++cursor);
            if (yych == 'O') { gotoCase = 46; continue; };
            if (yych != 'o') { gotoCase = 43; continue; };
case 46:
            yych = this._charAt(++cursor);
            if (yych == 'C') { gotoCase = 47; continue; };
            if (yych != 'c') { gotoCase = 43; continue; };
case 47:
            yych = this._charAt(++cursor);
            if (yych == 'T') { gotoCase = 48; continue; };
            if (yych != 't') { gotoCase = 43; continue; };
case 48:
            yych = this._charAt(++cursor);
            if (yych == 'Y') { gotoCase = 49; continue; };
            if (yych != 'y') { gotoCase = 43; continue; };
case 49:
            yych = this._charAt(++cursor);
            if (yych == 'P') { gotoCase = 50; continue; };
            if (yych != 'p') { gotoCase = 43; continue; };
case 50:
            yych = this._charAt(++cursor);
            if (yych == 'E') { gotoCase = 51; continue; };
            if (yych != 'e') { gotoCase = 43; continue; };
case 51:
            ++cursor;
            {
                    var token = this._line.substring(cursorOnEnter, cursor);
                    this.tokenType = "html-doctype";
                    this._parseCondition = this._parseConditions.DOCTYPE;
                    return cursor;
                }
case 53:
            ++cursor;
            yych = this._charAt(cursor);
            if (yych <= '\f') {
                if (yych == '\n') { gotoCase = 56; continue; };
                { gotoCase = 53; continue; };
            } else {
                if (yych <= '\r') { gotoCase = 56; continue; };
                if (yych != '-') { gotoCase = 53; continue; };
            }
            ++cursor;
            yych = this._charAt(cursor);
            if (yych == '-') { gotoCase = 58; continue; };
            { gotoCase = 43; continue; };
case 56:
            ++cursor;
            this.setLexCondition(this._lexConditions.COMMENT);
            { this.tokenType = "html-comment"; return cursor; }
case 58:
            ++cursor;
            yych = this._charAt(cursor);
            if (yych != '>') { gotoCase = 53; continue; };
            ++cursor;
            { this.tokenType = "html-comment"; return cursor; }
case 61:
            ++cursor;
            yych = this._charAt(cursor);
case 62:
            if (yych <= '\f') {
                if (yych != '\n') { gotoCase = 61; continue; };
            } else {
                if (yych <= '\r') { gotoCase = 63; continue; };
                if (yych == '\'') { gotoCase = 65; continue; };
                { gotoCase = 61; continue; };
            }
case 63:
            ++cursor;
            this.setLexCondition(this._lexConditions.SSTRING);
            { return this._stringToken(cursor); }
case 65:
            ++cursor;
            { return this._stringToken(cursor, true); }
case 67:
            ++cursor;
            yych = this._charAt(cursor);
case 68:
            if (yych <= '\f') {
                if (yych != '\n') { gotoCase = 67; continue; };
            } else {
                if (yych <= '\r') { gotoCase = 69; continue; };
                if (yych == '"') { gotoCase = 65; continue; };
                { gotoCase = 67; continue; };
            }
case 69:
            ++cursor;
            this.setLexCondition(this._lexConditions.DSTRING);
            { return this._stringToken(cursor); }
/* *********************************** */
case this.case_SSTRING:
            yych = this._charAt(cursor);
            if (yych <= '\f') {
                if (yych == '\n') { gotoCase = 75; continue; };
                { gotoCase = 74; continue; };
            } else {
                if (yych <= '\r') { gotoCase = 75; continue; };
                if (yych == '\'') { gotoCase = 77; continue; };
                { gotoCase = 74; continue; };
            }
case 73:
            { return this._stringToken(cursor); }
case 74:
            yych = this._charAt(++cursor);
            { gotoCase = 81; continue; };
case 75:
            ++cursor;
            { this.tokenType = null; return cursor; }
case 77:
            ++cursor;
case 78:
            this.setLexCondition(this._lexConditions.INITIAL);
            { return this._stringToken(cursor, true); }
case 79:
            yych = this._charAt(++cursor);
            { gotoCase = 78; continue; };
case 80:
            ++cursor;
            yych = this._charAt(cursor);
case 81:
            if (yych <= '\f') {
                if (yych == '\n') { gotoCase = 73; continue; };
                { gotoCase = 80; continue; };
            } else {
                if (yych <= '\r') { gotoCase = 73; continue; };
                if (yych == '\'') { gotoCase = 79; continue; };
                { gotoCase = 80; continue; };
            }
        }

        }
    }
}

WebInspector.SourceHTMLTokenizer.prototype.__proto__ = WebInspector.TextEditorHighlighter.Tokenizer.prototype;
